<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jens Christian Wahl" />


<title>stochvolTMB: Likelihood estimation of stochastic volatility</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">stochvolTMB: Likelihood estimation of stochastic volatility</h1>
<h4 class="author">Jens Christian Wahl</h4>



<div id="the-stochastic-volatility-model" class="section level1">
<h1>The stochastic volatility model</h1>
<p>The stochastic volatility model, introduced by <span class="citation">Taylor (1982)</span>, is defined by <span class="math display">\[\begin{equation}
    \begin{aligned}
        y_t &amp;= \sigma_y e^{h_t/2} \epsilon_t, \quad t = 1, \dots, T, \\
        h_{t+1} &amp;= \phi h_{t} + \sigma_h \eta_t, \quad t = 1, \dots, T-1, \\
        \eta_t &amp;\stackrel{\text{iid}}{\sim} \mathcal{N}(0,1), \\
        \epsilon_t &amp;\stackrel{\text{iid}} {\sim}  F
    \end{aligned}
\end{equation}\]</span> where <span class="math inline">\(y_t\)</span> is the observed log returns, <span class="math inline">\(h_t\)</span> is the logarithm of the variance on day <span class="math inline">\(t\)</span>. The distribution of the innovations <span class="math inline">\(\epsilon_t\)</span> is specified below. To ensure stationarity for <span class="math inline">\(h_t\)</span>, we assume <span class="math inline">\(|\phi| &lt; 1\)</span>. It can be shown that the unconditional distribution of <span class="math inline">\(h_t\)</span> is <span class="math inline">\(\mathcal{N}(0,\sigma_h^2/(1 - \phi^2))\)</span>, and we assume <span class="math inline">\(h_1 \sim \mathcal{N}(0,\sigma_h^2/(1-\phi^2))\)</span>. An interpretation of the latent process <span class="math inline">\(\{h_t\}\)</span> is that is represents the random and uneven flow of new information into the marked. For different time points, the variance will be dependent of this unobserved ``flow’’ of information, i.e. conditioning on <span class="math inline">\(h_t\)</span>, <span class="math inline">\(\mathrm{Var}(y_t | h_t) = \sigma_x^2 e^{h_t}\)</span>.</p>
<p>The original SV model from <span class="citation">Taylor (1982)</span> assumed normally distributed innovations, but this is usually to strong of an assumption. Financial returns are usually heavy-tailed, might be asymmetric and the volatility can be correlated with the returns. The latter is called the <em>leverage effect</em>, where there is a negative correlation between a change in price and the volatility, meaning that a drop in price tend to lead to an increase in volatility To take these features of financial time series into account <code>stochvolTMB</code> has implemented the following four distribution for the innovations:</p>
<ul>
<li>Gaussian: <span class="math inline">\(\epsilon_t \sim \mathcal{N}(0,1)\)</span></li>
<li>t: <span class="math inline">\(\epsilon_t \sim t_\nu(0,1)\)</span>, where <span class="math inline">\(\nu\)</span> is the degrees of freedom.</li>
<li>Skew-Gaussian: <span class="math inline">\(\epsilon_t \sim \mathcal{SN}(0,1, \alpha)\)</span>, with zero mean, unit variance and skewness parameter <span class="math inline">\(\alpha\)</span>.</li>
<li>Leverage: <span class="math inline">\(\epsilon_t \sim \mathcal{N}(0,1)\)</span> and <span class="math inline">\(\mathrm{Cor}(\epsilon_t, \eta_t) = \rho\)</span></li>
</ul>
<p><code>stochvolTMB</code> is inspired by the package <a href="https://github.com/gregorkastner/stochvol">stochvol</a> (<span class="citation">Kastner (2016)</span>), but <code>stochvolTMB</code> obtain parameter estimates through maximum likelihood estimation and not Markov Chain Monte Carlo.</p>
</div>
<div id="usage" class="section level1">
<h1>Usage</h1>
<p>The main functions of <code>stochvolTMB</code> are:</p>
<table>
<colgroup>
<col width="35%"></col>
<col width="64%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left">Function Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>estimate_parameters</code></td>
<td align="left">Estimate parameters of a stochastic volatility model.</td>
</tr>
<tr class="even">
<td align="left"><code>sim_sv</code></td>
<td align="left">Simulate data from a stochastic volatility model.</td>
</tr>
<tr class="odd">
<td align="left"><code>plot.stochvolTMB</code></td>
<td align="left">Plot estimated volatility (with confidence intervals).</td>
</tr>
<tr class="even">
<td align="left"><code>summary.stochvolTMB</code></td>
<td align="left">Extract parameter estimates and volatility with uncertainty.</td>
</tr>
</tbody>
</table>
<p><code>estimate_parameters</code> returns an object of class <code>stochvolTMB</code>. The <code>summary</code> function returns a <code>data.table</code> with estimated parameters, log-volatility and transformed parameters along with uncertainties, p-values and z-values. The argument <code>report = &quot;fixed&quot;</code> returns the parameters on the scale they were estimated. This means that the standard deviations <span class="math inline">\(\sigma_y, \sigma_h\)</span> are given on the log scale. This is done to ensure a positive estimate and <span class="math inline">\(\phi\)</span> is given on logit scale to ensure <span class="math inline">\(|\phi| &lt; 1\)</span>. If <code>report = c(&quot;fixed&quot;, &quot;transformed&quot;)</code>, parameter estimates transformed back to their original scale is also returned. If you want to extract the estimated log-volatility you can use <code>report = &quot;random&quot;</code>.</p>
</div>
<div id="example" class="section level1">
<h1>Example</h1>
<p>Estimating parameters in a SV model is easy with <code>stochvolTMB</code>. As an example we investigate the daily log-returns of the S&amp;P500 from 2005 to 2018. A quick look at the data:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">data</span>(spy)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">plot</span>(spy<span class="op">$</span>date, spy<span class="op">$</span>log_return, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Log-returns of S&amp;P500&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">plot</span>(spy<span class="op">$</span>date, spy<span class="op">$</span>price, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Price of S&amp;P500&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We fit all four distributions:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>gaussian =<span class="st"> </span><span class="kw">estimate_parameters</span>(spy<span class="op">$</span>log_return, <span class="dt">model =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="dt">silent =</span> <span class="ot">TRUE</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>t_dist =<span class="st"> </span><span class="kw">estimate_parameters</span>(spy<span class="op">$</span>log_return, <span class="dt">model =</span> <span class="st">&quot;t&quot;</span>, <span class="dt">silent =</span> <span class="ot">TRUE</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>skew_gaussian =<span class="st"> </span><span class="kw">estimate_parameters</span>(spy<span class="op">$</span>log_return, <span class="dt">model =</span> <span class="st">&quot;skew_gaussian&quot;</span>, <span class="dt">silent =</span> <span class="ot">TRUE</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a>leverage =<span class="st"> </span><span class="kw">estimate_parameters</span>(spy<span class="op">$</span>log_return, <span class="dt">model =</span> <span class="st">&quot;leverage&quot;</span>, <span class="dt">silent =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>We can investigate the estimate for the degrees of freedom (<code>df</code>) to see if the returns are heavy-tailed</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">summary</span>(t_dist, <span class="dt">report =</span> <span class="st">&quot;fixed&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">#&gt;      parameter  estimate  std_error    z_value      p_value  type</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#&gt; 1: log_sigma_y -4.780371 0.10353121 -46.173236 0.000000e+00 fixed</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">#&gt; 2: log_sigma_h -1.683263 0.09806688 -17.164443 4.901588e-66 fixed</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">#&gt; 3:   phi_logit  4.880275 0.26254873  18.588072 4.013461e-77 fixed</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co">#&gt; 4:          df 10.086369 2.10224617   4.797901 1.603371e-06 fixed</span></span></code></pre></div>
<p>Clearly the returns are more heavy tailed than Gaussian, even when controlling for the stochastic volatility. We can also check for asymmetric returns</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">summary</span>(skew_gaussian, <span class="dt">report =</span> <span class="st">&quot;fixed&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">#&gt;      parameter  estimate  std_error    z_value      p_value  type</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#&gt; 1: log_sigma_y -4.797828 0.09127159 -52.566502 0.000000e+00 fixed</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">#&gt; 2: log_sigma_h -1.556355 0.08899553 -17.488015 1.768097e-68 fixed</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#&gt; 3:   phi_logit  4.623512 0.23363739  19.789263 3.683862e-87 fixed</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#&gt; 4:       alpha -1.088827 0.14275943  -7.627006 2.402689e-14 fixed</span></span></code></pre></div>
<p>and leverage (<code>rho</code>)</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">summary</span>(leverage, <span class="dt">report =</span> <span class="st">&quot;transformed&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">#&gt;    parameter     estimate    std_error   z_value       p_value        type</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">#&gt; 1:   sigma_y  0.008338425 0.0004163323  20.02829  3.121840e-89 transformed</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">#&gt; 2:   sigma_h  0.273445746 0.0182642070  14.97167  1.124552e-50 transformed</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">#&gt; 3:       phi  0.967720808 0.0043682334 221.53597  0.000000e+00 transformed</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">#&gt; 4:       rho -0.748692587 0.0322489934 -23.21600 3.138829e-119 transformed</span></span></code></pre></div>
<p>There is clear evidence for both asymmetric returns and a negative correlation (of -0.74!) between log-returns and the volatility. To find the model that fits the data best, we can compare the <a href="https://en.wikipedia.org/wiki/Akaike_information_criterion">AIC</a> of out models and pick the smallest.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">AIC</span>(gaussian, </span>
<span id="cb7-3"><a href="#cb7-3"></a>    t_dist, </span>
<span id="cb7-4"><a href="#cb7-4"></a>    skew_gaussian, </span>
<span id="cb7-5"><a href="#cb7-5"></a>    leverage)</span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co">#&gt;               df       AIC</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">#&gt; gaussian       3 -23430.57</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co">#&gt; t_dist         4 -23451.69</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="co">#&gt; skew_gaussian  4 -23440.87</span></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co">#&gt; leverage       4 -23608.85</span></span></code></pre></div>
<p>Clearly the leverage model outperforms the others and is our preferred model for this dataset. Lastly, we can also plot the estimated log-volatility and percentage volatility</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">plot</span>(leverage, <span class="dt">include_ci =</span> <span class="ot">TRUE</span>, <span class="dt">plot_log =</span> <span class="ot">TRUE</span>, <span class="dt">dates =</span> spy<span class="op">$</span>date)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAEgCAMAAABcujGyAAABLFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrYTExMzMzM6AAA6ADo6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtNTU1NTW5NTY5NbqtNjshmAABmOgBmOmZmZmZmkJBmkLZmkNtmtpBmtrZmtttmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQZgCQZjqQZmaQkGaQkLaQtmaQtpCQttuQ27aQ2/+rbk2rbm6rbo6ryKur5P+2ZgC2Zjq2kDq2tpC2ttu229u22/+2/7a2/9u2//++vr7Ijk3I///bkDrbkGbbtmbbtpDb25Db27bb29vb/7bb/9vb///kq27k///m5ubr6+v4+Pj/tmb/yI7/25D/27b/5Kv//7b//8j//9v//+T///84N6qMAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO3dj+PcNnUA8EtpiQhsA5ZAm+wHIy3QQjv2i9GxZjA6eE3ofkDb+ypN0zT6//+H2dJ7T0+yZMt3vjv5rAfN9+5s6+fnZNnn8+1MixYVx+7SBWjRYiwa0BZVRwPaoupoQFtUHQ1oi6qjAW1RdTSgLaqOBrRF1XEg0Cc7jNvixWd/9Xvz1XuvfZLdql8hjq/eu00PRrZMRLQ+ZU7/JTOLN0+W+L8f7HbfsS89slW8S1v8fHfrYf/gSXFB/2O3+/oDWptrWhiJCs7favWxJNAnr0wA7VeIYymglDkDTWUWb54q8VNbr37jr94LgD567ZOnt35pzJf33ywsYp/U199bCOhEfTJbrT4OBZpqrckmPDXQ4OWSDk0A/fL+rYfdKHqnK9WzO28GC+7a/2YMoE93MoG5QBNlLYgG1IZsrW7Xt7v10I03d/v2eXbn7sd3bv3APL3jdpUff6tb4Qe4gjFfdLvQP/+w3/LjO7tXfxsC7Re+Sgtv/S0tdPl9ef+2X8OtH6QtRtA/2RecEMuKNnjSF6Gzwut0D/74oE/DRVd4ytCOlxx9Kr2xaADt62BXE+X6zbdsev0M4ZXfuWJyTan2frUoDdc0WF5eK268riRPdq/83DcLNkQD6kIAxR3hmxLot+90rfUvd9wUAKcDuEInoH/W971d8OoDCfRpuJCnEG4w673xGm4fvYszD4DarmNoT/q/j3Z2bLwrgL76wKZBOd2ldZ+88s8kx5bPjaCPgnHwKZVXlAvLJID6mj4brubT8E1DDcJrxY331Xtfu7N77X+4WaghGlAXNAftmurZne92Rxv9LpF2mF0rPjQfu/bs2/iVD41c4dZDtwvtdqa/MF+8txNAu2542Cf+2ieJhR2uV37v13DrR2nHc9BH9h/ssl75l/d3bmwUc9AuMfMHyslm3JWvq9kjJmTDzUGffVMOq11tftlVtR9bfbl2t3uSt52cPh9fGV97v5pIgxbKBqHEwsbrFtwNmoUaogG1EQD92t/81r3IQG/3Hd01FLbW//3mH+5QG/tdqHv0TPYHPnl065dPd8FCO6L146FfI5H2EGhPBPfwblf47Jv/2NMT63R9+3vcTcqq9Rn0VD/e8UGOPYrvBtBuje/iylgbE5SL0yOgvqa+9n41kQbPLqhBRGJh47kF3Cy+IRpQG3IOagea73wogd6lHu8HL7dbIkRPmbabIAYHSXhY0g1Udncsjiv6NPsN/BruPFGQ9hBoXwo/lezHwFf+6/6bbjoZHMWLI5h+8vvwid8omIl2A2iX3hf32dSbwQMql0uPgPqa+tr71TgNv5AbRCQWNh46pGbxDdGA2ggOKfsTh/2OMw2026l++5/+84/3jwPaL31kxxAJIUo7cZqp2+YR91i31aPu6Oh2n0geqI1HXMEnEmg/Ee3Tk7MG+eDcQKlZfEM0oDbicx7/+/f9RD0J1LU/zxP9uRu3v+J96/guvnPyr/dvm2gXH6WdAPp090Ma7foVf9gBe/Lar8llFmg/QcH96SNZ1afdkxBoYhc/AOpr6msvgcbDsV8jAhpvLpqFGqIBtSGAPt39ZTfZ/HV/1IvH1jHQbpr/xYN+KudW6Gd2X3RTKHvG8auyg6S+8f+6H4fCg6RB2hIojsF/5kfA7tC3O8R5eutbt+lEPZ0NkAN5d7jxxXt0zPLVr+VnEf0AGgC1BzjP7suSJ4D6mvra+9VEGrRQNIgHGjQeOcRm8Q3RgNrgT5LscXUf7mTK3SFQOlOCK9Bu6i7u0spOM1mZbkiUp5mitEOg7jOgJzsxAton3XTtTQKKG8kR9AmliCWVe/in9sBLzEFxnTejckVARU259sFqlAY3DTWIBBo0HjnEZvEN0YDaEEDdifrvdq3y5YPd7T8ND5LsGexf2JnSg/6kybPu+dce9ql0k9dXfxeeqH8WnKj/u/u3RZbu8TN5oj5M+08SqMtMzhJ6AXbsdF2K6/wpdZD03U8oq7/40G+O5+j/cIeP4vGQalCuCKioKdVevi+CNFzTmAHQsPHYITYLN0QDes740s8fD43w48YWa4tagT678/VuZvvoaF1fPLiuAWVzUStQP7M9Jr687y9GarHKqBWon9kelch7YrbYYo1RLdAWLfpoQFtUHQ1oi6qjAW1RdTSgLaqOBrRF1XEY0G+0aHHiOA5oftHNQQnOizPkcR1ZrLgaDegWslhxNRrQLWSx4mo0oFvIYsXVaEC3kMWKq9GAbiGLFVejAd1CFiuuRgO6hSxWXI0GdAtZrLgaGwMKcPIsZkedLVVLFg3o0lnMjjpbqpYstgh0DtL19uy582hAl8ijAV1bFg3o0lnMjjpbqpYsNgcUGtBVZdGALp3F7KizpWrJogFdOovZUWdL1ZJFA7p0FrOjzpaqJYsGdOksZkedLVVLFg3o0lnMjjpbqpYstgZUw7xPk9bbs+fOowFdIo8GdG1ZbBLoDKHr7dlz59GALpAHgAJoQNeUxeaA6gZ0VVkcCfRmXdEB3fdAL12OFsXRRtCFs5gfVbZUNVlsDKjqgaoGdD1ZbBCokkCnrK63Z8+dRwO6QB4dThUAndzbr7dnz51HA7pAHg3o6rJoQBfOYn5U2VLVZNGALpzF/KiyparJYlNAoQFdXRbbA6rPCrTgjFaNLVVPFtsCqlxoZtOA1p7F1oA6o8Rm+kOlBvTCWWwMKDSgK8tii0Dxs05oQFeQRQO6bBaDLKdXqbGl6sli40B1A1p5FpsHOiGoAb1wFtsFar+ArKeG0Ab0wllsDigEQNXUtaFHA50WWmNL1ZPFRoHCmYCWXL1fY0vVk8UGgWoC6vb3y2YR59iAHhnbBKoF0HFBDeiFs9gS0F0DWmcWY220JaDAQNWZgY7mUWFLnTmLBtRFDxORAjSg9WTRgLpw9705L1DVgE5HA+qiAa00iwWAPn/r3r137aNP79279/3H0daJqLDZM0Dn6Jn7Q3X+M4HiLE4S2TzmVuiALKbjeKAvfvqBef6jD/qHH72b2DoRdQO1d2HU9hsg40KPBwoN6ESMNk8Z0M/fMEjz5b99kNg6EZUCtdeHOKDqEKAzO7QBLYgFgPbRj6Ldv+/cw539N/q49L3PZkWv5cbeH1Ttuwdq319cv59zs7vZN8ZzObmtqrynXg2FGm3UYqAv33+7/9Pv6P0ousYRFPwIqnAEHXkHh1nMujGey9Lf0jm3bRtBxxaWAn3xztv+Cc9DqwSarW8AFOwXkBVM7OMHQOf1KN7usWKgiwm9LNDnb8ljo6qB5k+Nnx/ozn024H77pgHNlWFsYRlQ7/Pz1z8zL39V82mm/HAlr2JCoHBqoNCATsYCQPuTn92x0fMfP+4ffo8P5FcF1Pnsl4RAR7/2sQhQ7Sai2wQ6ncEic9DxrROxAqAKnc4FWt6nDejmgYrKBcciYcO7lxCooRstE1DeySdaKgaqDwGKE9EGNLPGGL71A+UGYKDDTxcngOoGNPf8+Cy2DhSOAaoZaO7QfwGgugHN5u6y3BRQSADFlyaAwgaB7i4M1J1V2RhQXQLU3cl2NlBlj3eKC7hzZwmqBhruak4ENJMqnpfeHFAIWxpioE4oXmDPF4wUAVWzfi6ZgfY55O4Rce1AqdHTy7YEVEugOgRqx01+MzegGCmgBxI9HKhqQG27zwQKw2rs5gKF/qNU7XLQqkqgYalg1gymKIvEMatfdPVA5d2/JNDgpkv2EtACoOEYtxRQ5YAGt8aPanH6aEAHcXagdHSkI6BwGFDwQPlVBxRXK+lHD1RXDFTWeuL67QOyaECx7gTUfg9OAgU0GwGl8+coNA9UjNG4sx6bVgWByTukSaDQgG4KKBDQ4D70DqgQ4oDa00sI1LorAapmAkWhlwHKOR4BtNRrJovdOFDbQFcNVEugkASqp4Hq8wAdbtMltWGgelNAtQcKpUCNBKpPDFQluqk6oINruxrQw+PGfaXCPenP42SB6uAlAopTIJyFanlgNQZUAeSaPAoCCjUDFfVrQI+OoKI3uEN3SxTt3EmjW9CfgbSX1EmgQF/FkEAF6kmgk8cS2C8TQOHyQOV5kAsA1bJfErFtoOYIoBN3t5dAdQ4oVAd0WMiFgCaPEO0866qAwhAotih4oHh6k17XBBQSQJ1fhZfYg6ErwDxQeap1FlCoAChlOANoXK+TArUfYKwN6FhxJ4HuLAgdA7UtkQOqQ6AwCVTlgYosSoFCOoHiZhlpr7lAdycBCoOP/ClpnPxcOVAtgOJlniFQtw9XWaDsLgPUHzu5T5+KgeJpPsWn60uA5qp/AFAoAarOABSG702b9FaBqgCoYqAiGTgQKM4Hsr+wNB8onB5ofhqRAhqWsuhsRR+ZLNxQMKw6ZV4F0NI6Tq8ddmcAVEmgfoeKpEKgRgKFcqBQDJTOYVUCNJeqNULFwgmSOhdQ2zQnBlp4d6h595IaWxbdaKqv3x7okYK9o7B35Ozre0UvgUzHAnUpgt+kz73/p+sqWhv2e34ImBrIV5OF70pCNyojoN3G8SbdK/u4RrlbaeWaZeTWW5QWZFeyQKlYDLQw+aJAoCqRjAc6sn11I+j45V7pEdSOhHaIosMRHkEhN4LSTcMIKF3OAW743PkRVJ7z56/TZ0ZQSI2gPEYPR1AN8XnH3NmB/Mh63AgKfgTj2hUmH8b4CJoaJQnoaBa1AR3s8gaLZR7uHa9HgYoXZDrHAk3vmARQvK0dd1AMFAs9DRTClLNZphZ5oOnVJFA4DVAYBcodlYvzAC0XOpyUxYtlHkOgfn+q/MCaAWokUFoD8OhGZYCS0HSTJ4BSB+kioKlhdljxcIt8a+l5QOlmAYXJh3FtQDOFOg4o2bH/6mKgINYADGy2AqBBsry3tEAV7ub7k7ADoGDEaVxZsFRL5ZtlDKgqBwoNaBD55nZDWCbVsPumgYrd9/FAd0cAdZdFZIBGBYvrTO2Sa7FBMXjRJFAIgeItKeNiFsXVAc0dC8DYIBpesnkD+EGNSQFVRUDjfTwDde1WAhREsocAhSCFEqApQSVA4ynGHKBTULcDdOym3KL7ACRQ6NuWabp/6XpknQLK45aTkwQKIVBesBRQLH0CaErS0kBx/yGAqtMA1SsAOihCFqgeAyq/hDgACjFQFQINm12mQ0C7vzvav48DVcVATQA0fI+44T0EqmcC9afZE42pcNsagCYGKWr2ywMdntsbA5r/4lYEFG0RUEEzAgoxUBMCdT9IY08FyVEyBqo8UDUF1I7GHii5D1pgFlAeDcPF/HoR0CB/EwDFdlPRB17LAA2r7otXBVCoHyjgiSDlh0+3dXDJaQTUD6w+VW/ZlSECqhJAVR6oJKnmAwUBVJcChRAonB5otrdtnB4opIHmPjDR9DX1VAyAKup2Bgr0JwAKKgvU77k1t2Uh0AGNHFCfhwmyTQClHa7x/4JZDqisNpcBHypsQ51I/higdmBOAwU1dsTRRwMaAcVtESiMAwWZFAyAqiHQMNsBUEIsMUZAoxlAEiiVd1GgE0LHgOo0ULgwUG65cwOFECj9CfKJxrIYKCYENzt/pfPBQE05UDUBFMqABtOC/oNbnDkEkwmQpfJAQQXJhzOZvKXJEXRoADvwQkD9d4JSF/cuAVTvJ4BqHBCA1hL5RM8GQPHI+wZCoHyRbQoor8oHHDFQccgNGoGKvhPH1LgWH95IoMG7qwyoSgPF9gPwQHUElKt3FNAUw0sDtU3JxYgLJ2/uJV+eBZSGNEgABbxl13FARY+JjHJAaZwmwiNAdxCnYzJA+Y4+WNL5QBXPHJJA3RsvARQWAcq9kli0PqBKLQmUvi8HMLhkNgNUSaAaN5RAdzjquDeSAb97OBioHgeqSoBCKVDffjFQ5YF6k4sDhWCRA5pN05wFqLsFdrQ4ACoeHgAUOWpqCgM0WXT3lHNA4+s3k0DpgvlFgdK7NAkUkkCpM4GU7SKgssUOAgoQA6XB3AOFCKh/56RiAihduF8VUEgDtff4EmCGQHNf6Q2A6h6oYaAQArUfftrPRRBo1A4JoP2xRAIoCKDGdbelRkAVoyNe/kM8I4CaEaCMIAkU+Oh+AJQLlwTKf/1oDjQwh0B3CNRVKAF0dyxQXRtQPQ5UHQjUT5AGQO0RFrjrxuYD1dxLQ6ByGshjIU5uFwDKN3vybzFuGKAZDELEd4UvuZAn6uMaswCoXapPBnQ3ACr3nBcG6m6HCPHHu0Cq3LNoh2WFqkyZc0A1AYUEUCgCSnceI6EpoK6L3Hg2BhSnAEOgEAPVblXAUTOerzmgOgCqfYvBNFDgRlXu6+klQKlrTgt0VwlQ7W/eys0+AVR5hmGIb8n2Z05GgHJSdLZvPlD8fRoJlIvvgIbXKBEjKAWqEajyQF3uaaAuNb4IxZQAVTFQ7YEqBKqTQOEgoIPFBUCzKdo4L1BsmgFQv8caBwoBUN+gBNRpGQA1CaBRuvb/fJLTAXXppoFCAijkgeL4KA+oAI+zBFA4BqhssixQrdle32I6AOq8jgCF+UAhAAoDoBPj50mB4s4oDVQlgIohLAtUTJBCoOzQA4XjgbrrR1JAwQOl1/HtEwHFEcuEQCEAqpJAdwFQYKAOkiGgMA8oCKCqAR0AhUWAQgKoiYDyrx2aeUCxqxzQ/RRQvn0g0O1MkkC59PwQh84JoBADVRmgQZNFQCkPoFNjdOTqgcI0UDrqTTSf7XBZVb9IEVBVI1DIARW95ws5CRQSQA1qCICCBwo4bB8NlHQxUHtjXO2BqgCoH1pHgLoKBUDdprawWaBKAKWaiybD70zzzWmTQNUUUNeYvnNoN5VqPtvhRurjRQQUUkDjuXMiCoG+eOfe659Fj8xcoDjKaWBcxgMFBioWxrV19QTuYGzJEqDjLZEBqkaAuvsYSaCagdLYGGbJY7ErzhhQIkKSMkAhAMpvBALqKr2TQFH/EKh9rkeBZi88mgAKpwf68v13zadvhI/k1olgoH5EHAMKMdBEweEyQA31WAjUuCE2A1Tngcris1QP1HGZBxRo8Hb5DIGCBKpDoJgrAjX8aj9h3c0FGi/nWp0W6IufPTbPf/w4eCS3TsSNxvZ35Gx74gRRHLqKdyoNkAmgYr/ogZL7RYCaDFDlzmQNgOpDgJpSoNq/I2g15T5wxWOZCCjwcMztZHJAtQCqc0D502EJVM0HChKoOiHQ5z/5zLz46QfBo2/0MXLXp31/Wy93N6++cDf2Vln9zaj2e+odewep7sne3d3KNvR+T30i7jKFf+z+Yu9SwYEZE3CpAWAW9olMKH/7LM4D8E5XA6A2X7cMVwR3a7B+8X6v6HV7/zH6Jt8ebBpxHv26WEIy5R5gujbr/R5fUC6TPjG1t4VgoCIVmRi30w0uttsAbaOwT9xN0FzGPIYoaj1XetvSO59oX1lItyL4Cg7uhOYyACyA7IcdTPdK6c3DPn+dWPpHkncibjR+2pIdQXk6poIR1A98ftaPf2xFNU2U5oygqelRGG6gHQBVNILygBiMoO5o3Y+gADwkuXlAlAcPIzFQO/i4l+IR1O3VEyMo+dQ+MW4ng9M/GkFtYXgEpatiKB8COhhBIRhB3UUDibmX7XCTGEGBRkkqaTCCTvfKMSOo3DoRNyoDtN8ragmU9h2QAQrFQI0EangvihuPN8QIUPdjQnR7vOOBgjsBVA4UyxMChRio9lUdA+p+VU8C3VEmEVAqHyXqfm8qAAr+3xvq4bDCEVBsFOAWH++VU85BXedFQCEGChFQEAMfMAisbRKoCYDSqGwYqJkJVFN/lgG1pO3r9jN1BmpyQIGAMgBXSvrE3enB6SUDBQ9UcyoeqHIF58EuD9R1ygCoAglUcbmmgYLkdimgL99/m4/i3y47it9hWyjafxj8Fow7rnD36xTnZOxDrQiozgJVDFQTUJeE4cFWAGUjM4H6UQZw2JoACscCRY3umj+IgKoQKIRAdQFQLrEYNZJA/ckoepXLrgfn6ouB7iRQ6h+zGFA8+9kPnaXnQXeu9yaB+tkPjwd2Oy3qEQMFN4fKA8Um0+KXPY4AaoZAYQKoHgWK63qgzqyrhgOq00Bty5El2hbB8W9wUXMHQLHxIqA6AdS1An8IyzslhXMPOYiOAwV9NqATWyciAIp9wLRc+7i+dG1u2xvPTGFrR0C5jTEVcCcpDQ2V9lEMVFysPlEVBupiFKgrGQOFACgoAjr88GouUNYngbIlGoUngMIQKJ0FdUBNDBTctCIAqjJAIQCqIqA6AIoSqgKqPFC0pfk1AVSHQCECigMlAtU4Nuq9TgOlJpMn7sqAagIKtOdkoJxHFigyUjRMJIHi9SUBUEgBBXcrnjRQFQJVGaC7NFA1CZRvBFwG1DfJGFAhoVagSvgE6isECgwULRseAPhPDBQioCYPdCoQKF0+CnTsUQSU6eDgUwzU4HoONQJFbRaoCoAiHfe/EKjbX1Auik+OzQLK002bSxooDIDuCoCa1QD1vSqAKjnlyQK1KrHL7MNTAjVUOA9UjwAFLYCqeUChDCgkgYIRQDXuBpSiKewQqOwUCdQ3VhYonkgDvoCwCKhsLQEUqgSq/UuTQH1FkIvGducuWxKo2ywPVI8AVeJ0EL2WBaqBMCeA6gioHgB1z9yAp1wSNCASUMV8B0CF0COBctcQ0D2E32k0EVAIgUI1QLXGptcpoLzSEUDpvAq1Cz30J15KYxwoRECD2XQZUKdIc02Nn7soFQJVaCQNlPOaAZQbuQio7yjXxA4o4JkmEEAtSwIqOgLWAlQ7cKNAVQYoHvvb7mag1MHLA4Uc0PCbfwiUipwEarJAtVbcTxKowtO/RwEFyAP15ZsDVDn1WFn+LmQaqO8IyAH1H8uYSwK9oQ8rxoDyzxoNgfaPdBqoKgXKTV4aBNT4MVungBoCOB+ocvuUg4DCBFD7LAWUJlMDoDQ8+l23KQAKDFSPAAU6NVczUNsR4vx8EigXXWELI1C64hmosjFQGAIVcQBQ3IaB2kJyj6WAuvMxGg4Dylkqni7QMTUDpZ71b11nln8zBpRYzdCbG4G6V3JANRUhCxTc228EqIYQKIiWVBIoCKCa355TPXJKoNRpCFSBP8dBQPmDJrJLhw12EMGTT24PNQY080X6o4CSnBlAec6iDwdqpoDCIkDdCV8GapvYeKDcI5hE/y+dbaUBA3drDijMAeqQp/ssjvMANfS5DAHFT/IGQN2UCHBAUpcHuh8Hit89c9MP208I1GSAwgCoEUBhBCh+MuT88Rt6FKgZAYpNy8USQOn8hADKkxB3sKgRqFKzgcKagOo0UMPtKBpWC6DUmacDyhdtggQq1zM4uQuB8jlvW6pB5kC0BkC5TjFQ0c8K8DAnAVR7oKoQ6E6WIAkUUDzOAXQEFACPMGwhEWjwxeoBUFszd74/e/uYME56b6YpoKRScfgGo2bESdcE0KEFTOecQPUkUN57poACDj+2lyeA+iaLgEIGqBFAIQs0LOUYUE1Abf3BDYgZoGZ9QMEDBdo7pYFqBkrdQScHaKZuTgsU/BFoYmU8ik0CNYnMc0BBAtUaioEC+A9Z00AhBArlQEkdbuWB6hiongMU064IKHigyp3FZKD2HZUHqiKgOgaKjbEgUH+BDh3IlwB1fYerLgcUWOAEUOKgS4HCAUABgbp+EUDdCTd3qC+A0qSNZ/RiNFoTUNHcCaCoUY8CTe1NzcJAkzPKNFDIAvW1Vlx8BpAFCgmgnnQEVOPTUaB9uceBUjY5oNoDtX04F6iuAagrOgAf3eKb7xCgah1AdxJoKgOqtU4ABQFU4bzSNZ47eNIqCVRLoHST/yxQTUB985QC9Z/QD4CqIVB3A/Ys0MQuKRWnvcOypjOyNEM6EKgSQIE6+ERADQE1BwKFo4H64TAFFMqA4qiLBzV+bHcfmMwBqvFbUhmg2gMFBoobrRGoLSgdT0wBpZMpegJoGqJfozgCoJRwHihkgHJag21mA7XZ96/vsPXGgCoCqmhTTZMJAgoSKFckuGzBOhNA6UbAIVA6diCgrhB0yZfmSdkKgBoBFFJA8SFkgdIzBmovH7+ZAJqeBo4GtWeQsBsrxoCqI4DeLASUPulRkARqjgNKo7IfMGjepZJAlQRqX9kFQFU1QN18LgDqWoNUJoHyIRXVxgPF0aoI6OxIAjVTQF3p5wCFCaDuSJKVeaDGndtMAdUSqBoB6r/dxxUJPvXKAtUMVPnpVwhU0T7H/QQQt5otqAeqagEKAijkgeL5UJrAmAxQwI/yCChX/sRATRIozVFzQJPp4xsNIA8UBFCYBkrfpOKvywqguzRQvqCI6zEEiuuGQOnyM/rAhYDyh88CqKoeqGvqYqBaAgWvMgSKo5lt0BMAxfzjhJcECjFQMwHUREBhAFRcL6Zo6FX6CKB6AiiPHWmgQNPT1QGlaxQGQCEEalJAgSuPM1vxm/SnB5rIAg+EsSLEYD5Qw0Ap00KgUAr0xhi6LAk0QATURB/LxkCtNXw+CyhcHOj47eJsndzNzxDo3t03zb0sgLr7t9m7q7m7pYEcQwkoAN3Nzj0MMlsw5N3a+N5uiSzgxtcE79B3AyouW7jJXoG7TZy8tRsDpUz7u8/ZRgG+LeCNA+puISeA2sUA/q6BbkNbom4be6c8vP0eYImB8s/dlo77aQ8uCb7hHSg5cuBjd2M/Bkp3zHMlEY21j4CW9MWZRlD6uEN852diBPVAQQK92Ag6vHaOR1CD41XRCMp72IkRVMsRFJIjKOCemQZEOu/joCj63ECOoJQ65i8rGpSSukkP+ikNlEdQN09hoOHMwVXorCNofpEA6go3BAo5oCYL1PA5kbMA5Y7LAzVLADUDoIB3oUsCNbS3DIFCCBSOBWoCoGYMqCu+AtzHk8IsUKgBqAmBut/kIaDGuAMhnuukgKLgiwLl4iezwBl2DHQkaZ4CAuWTBQqjQEHxOz0P1OSA4l7KFysF1AyAwhAoMFC+UkB84XWNQGnHGQMFCFssAqp5s5MD9TEPqFuzHKgLxLBD9oUAAAhRSURBVOOPpK22UqA+yxGg4uadNHRC0GgxUE/fA6UcxoDi6Y4JoFjQaoGaYqC877gUUOOLn8tiHlAzB6gpB2rmAjUR0LCQeaCaRLo+UbTTLwEK+FvmlQLFb1nxW7cvqbgXUuVAs+xcF2o4EVB6wTA2Hi3Bt8h5gNq2l9PQ+UDx0pcagBpDuxJbOLqrgAQqriWJew1fKAU6/fXVA+OGir840CAL+5IHao4Eao4Eyh11GFAQQINEHVDs2PQVaHGcFKiRQCEH1IwAxYvFyCdvVyXQqTXdcjgGKAig2jdIAFRHQGFxoFoABQYK00CNAJr5FkQcJwZqhkDNAUAhBEqP0j9RvmgIoJk1lgJqCoDq44EiE8pH1CIuZQBUC6BaANVJoLh4vUCxvIzO9UUCKOgAKC87O9A8ugOABjVNADXYOPwJJAHFv0OglDIB5ZvQLAXUZ6HdqdwAKAyBiq18ogJo/qgzjLMBBdy3eKCmCKjGQ/zrAmrGgLrVNJgxoCYHVPM1K26bEaBhLQalHAWK8y4JVCkauhWPqmGiBvh06iqAuteo6ONAxdILAB0/TeCud6PHZUDDLEBDmMXBQGEKqJkDFLJA8QB2ABQ8UA0mDxTGm4ljDUCheqBC5TmB8ia8lt3VmHGgfn2ZX1RKYyRQGu6wkwgo8EeA3X83A6AwAXSklXycFmhQugKg4WUa2Bj+300BBSMHPftvEVCIgOplgNLrCBQ8UPsFyAAofmU6DdRUDtQ+Dl4zAmi4fh5oOo8TxKWAmhRQPQuoe20E6FgpJVCtIQVUp4ECAR1MMn2i1QIddAIB5bdXsCwDlNu3JqD8eAJovKsoAuqTtn/pHR0BNcZfqsJA9TFAzShQnQGq+N4RyUTrBjp8jYdFE+8QRFwZUDMNFPcstQOFFFA1DXS4NBNnBpp4TQAdLFwj0IG0wcrRcv5QeAjU5IAaSG2SASryKA0GalJA6QAWdwZuZuGAmhGgpmqgBobvW1nKLQEdZrEYUBq/E0AnyhVnLvYJOqif6A8wVw40cWmweME3QlSlyoGO70EH7XAaoPoooCYL1CSB6k0C5SPeGoCOrTQLaDqLHNAwmwHQQUlOBFRsSiczzTFAkzO+ZJwPaKLfpoAaCTQhvBagcrd9OND4CHKQ7aWAwjRQmAHUXB/Q4GhqPI+lYzZQsxTQYbZhpyZ7mFn4z6COBmoOAErfCxyWz6VwLUBNNUDHIwJ6QBYlA+8hQM3BQEWiWaBmCBQ/ut8CUPcqAS3MY+k4J9CCXOoDauoA+vyte/fetY8+vXfv3vcfR1snogSouRagsmrnAprc5DRAwzdGHqi+GNAXP/3APP/RB/3Dj95NbJ2IuUAHSxvQQSbhNCe1RQIoMND5RfOJxi+ZBFD8sWWYAmqWB/r5GwZpvvy3DxJbJ6IM6EiA/LMioIdlUdRdMPIMX6N+TwI9MIqAGgmUb1w8TIo2Lx3Oy+eg/Sja/fvOPdzZf6OPkts/HRgg/yx7c7Dl4/jilaRQsA7Q3c72EL5wRMAwDbwNGd7nDf/b473P7DmmdMb8GpQ2WTHQl++/3f/pd/R+FJ03gh4UGxlBl8qFVjnvCGrcCIqzMvddj7ERdEaDTQP96N69N/qR823xEs1DzwDURbo+DWh2lRMD9SnPA2pOANTG87fksVEDGkd9QGFRoGMv40DqgbpLqlInroflnIwyoN7n569/Zl7+6rDTTEdEA1qYy2mAjr6cBVpSzskoA9qf/OyOjZ7/+HH/8Ht8IN+AYmwRqImA4noXATq1dSLOgKcioOfJ4iCg5uRATQN6uTyqyuJCQAuKkwBavO14NKDXlYUHGrxw6mqEQKe+lmUa0M1m0YAmt05EA3qRLGDwYPk80tnOA1ocDeiVZnFZoEed1giiAb3SLBpQuXUiGtDLZnFeoKYBvVAe15FFAzqMq2n2a8jinEDLr0UuigZ0C1k0oMO4mma/hiwa0GFcTbNfQxZnBXrwl/OS0YBuIYsGdBhX0+zXkMWZgOKjBvSMeVxHFg3oMK6m2a8hi/NWowE9Yx7XkUUDOoyra/Y1Z9GADuPqmn3NWZwZ6JLJNqBbyKIBHcbVNfuas2hAh3F1zb7mLLYL9PA7UrVoURJtBN1CFiuuRgO6hSxWXI0GdAtZrLgaDegWslhxNRrQLWSx4mo0oFvIYsXVaEC3kMWKq9GAbiGLFVfjSKAtWpw4jgI6ZnfpBC8TrRqVRAOajlaNSqIBTUerRiWxONAWLZaMBrRF1dGAtqg6GtAWVUcD2qLqWALo87fsL3W/eOfe65/xn/5H6r7/eHrjeiKsRvf8x4/Fs9VEshrr6w2KBYD2Pyj//EcfvHz/XfPpGwb/+B+eXUuE1TDm875H+dlqIlmN9fUGxwJAP+/b4aN3X/zscf9uxT/+t+XXEmE1zEff+/fuX3q2nkhWY329wbHQHLR73z7/yWfiT7eHsXuadYUvv3H7Rv9sTTGoxjp7w8YyQF++/7b9we6uSfBPt5dZ3/tWVMO4nvXPVhTDaqyyN1wsAvTFO28bE46g9vWVzXxkNcx6R9BENWysrDcwljmK76sezkHtgnU1SVANg/vG1c1Bk9Wwsa7eoFgAqGsRu2OxR/H2T7+LefmrNfVsWA3jetY/W0skq7G+3uBYAGh/jq2fgg/Og35vVbvGqBprPQ+arsbqeoOjfZLUoupoQFtUHQ1oi6qjAW1RdTSgLaqOBrRF1dGAtqg6GtAWVUcD2qLqaEBbVB0NaIuqowFtUXU0oC2qjga0RdXRgLaoOhrQFlVHA9qi6mhAW1QdDWiLqqMBbVF1NKAtqo4GtEXV0YC2qDoa0BZVRwPaoupoQFtUHQ1oi6rj/wFBgLCJCAGe0AAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">plot</span>(leverage, <span class="dt">include_ci =</span> <span class="ot">TRUE</span>, <span class="dt">plot_log =</span> <span class="ot">FALSE</span>, <span class="dt">dates =</span> spy<span class="op">$</span>date)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="comparison-to-stochvol" class="section level1">
<h1>Comparison to stochvol</h1>
<p>The R-package <code>stochvol</code> (<span class="citation">Kastner (2016)</span>) provides a Bayesian framework for inference using Markov Chain Monte Carlo. An advantage of <code>stochvolTMB</code> is that optimization can be a lot faster than MCMC. We here compare the leverage and the gaussian model. Depending on your machine you can expect a speed up of 20-200x.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">library</span>(stochvol)</span>
<span id="cb10-2"><a href="#cb10-2"></a></span>
<span id="cb10-3"><a href="#cb10-3"></a>stochvol_gauss &lt;-<span class="st"> </span><span class="kw">svsample</span>(spy<span class="op">$</span>log_return, <span class="dt">quiet =</span> T)</span>
<span id="cb10-4"><a href="#cb10-4"></a>stochvolTMB_gauss  &lt;-<span class="st"> </span><span class="kw">estimate_parameters</span>(spy<span class="op">$</span>log_return, <span class="st">&quot;gaussian&quot;</span>, <span class="dt">silent =</span> <span class="ot">TRUE</span>)</span>
<span id="cb10-5"><a href="#cb10-5"></a></span>
<span id="cb10-6"><a href="#cb10-6"></a>stochvol_lev &lt;-<span class="st"> </span><span class="kw">svlsample</span>(spy<span class="op">$</span>log_return, <span class="dt">quiet =</span> T)</span>
<span id="cb10-7"><a href="#cb10-7"></a>stochvolTMB_lev  &lt;-<span class="st"> </span><span class="kw">estimate_parameters</span>(spy<span class="op">$</span>log_return, <span class="st">&quot;leverage&quot;</span>, <span class="dt">silent =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>We can compare the parameter estimates of the two methods. Note that the parameter <code>exp(mu/2)</code> and <code>sigma</code> from <code>stochvol</code> is the same as <code>sigma_y</code> and <code>sigma_h</code> from <code>stochvolTMB</code>. Both methods give almost identical results.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a></span>
<span id="cb11-2"><a href="#cb11-2"></a>stochvol_gauss<span class="op">$</span>para</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">#&gt;                   mean           sd          5%          50%          95%</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">#&gt; mu        -9.611533785 0.1854455626 -9.91175182 -9.611774497 -9.304678419</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">#&gt; phi        0.978189757 0.0049148914  0.96968612  0.978414831  0.985836137</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">#&gt; sigma      0.229775055 0.0203786934  0.19733459  0.228942708  0.264098047</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">#&gt; exp(mu/2)  0.008217761 0.0007671236  0.00704191  0.008181439  0.009539261</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">#&gt; sigma^2    0.053211825 0.0094502446  0.03894094  0.052414764  0.069747778</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">#&gt;                 ESS</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">#&gt; mu        6230.1953</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">#&gt; phi        327.9347</span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">#&gt; sigma      152.4001</span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co">#&gt; exp(mu/2) 6230.1953</span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co">#&gt; sigma^2    152.4001</span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="kw">summary</span>(stochvolTMB_gauss, <span class="dt">report =</span> <span class="st">&quot;transformed&quot;</span>)</span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="co">#&gt;    parameter    estimate    std_error   z_value      p_value        type</span></span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="co">#&gt; 1:   sigma_y 0.008185065 0.0007314678  11.18992 4.568554e-29 transformed</span></span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="co">#&gt; 2:   sigma_h 0.222436260 0.0190054225  11.70383 1.218261e-31 transformed</span></span>
<span id="cb11-19"><a href="#cb11-19"></a><span class="co">#&gt; 3:       phi 0.979034580 0.0046594721 210.11706 0.000000e+00 transformed</span></span>
<span id="cb11-20"><a href="#cb11-20"></a>stochvol_lev<span class="op">$</span>para</span>
<span id="cb11-21"><a href="#cb11-21"></a><span class="co">#&gt;                   mean           sd           5%          50%          95%</span></span>
<span id="cb11-22"><a href="#cb11-22"></a><span class="co">#&gt; mu        -9.569375399 0.1053851888 -9.739817718 -9.571446103 -9.400002030</span></span>
<span id="cb11-23"><a href="#cb11-23"></a><span class="co">#&gt; phi        0.966952934 0.0041187166  0.960195391  0.966853189  0.973557574</span></span>
<span id="cb11-24"><a href="#cb11-24"></a><span class="co">#&gt; sigma      0.276351629 0.0172514582  0.248100974  0.277044222  0.304057250</span></span>
<span id="cb11-25"><a href="#cb11-25"></a><span class="co">#&gt; rho       -0.724949416 0.0328632332 -0.775144574 -0.726905055 -0.667578807</span></span>
<span id="cb11-26"><a href="#cb11-26"></a><span class="co">#&gt; exp(mu/2)  0.008368349 0.0004417329  0.007674065  0.008348085  0.009095268</span></span>
<span id="cb11-27"><a href="#cb11-27"></a><span class="co">#&gt; sigma^2    0.076667806 0.0095068932  0.061554093  0.076753501  0.092450811</span></span>
<span id="cb11-28"><a href="#cb11-28"></a><span class="co">#&gt;                 ESS</span></span>
<span id="cb11-29"><a href="#cb11-29"></a><span class="co">#&gt; mu        368.69311</span></span>
<span id="cb11-30"><a href="#cb11-30"></a><span class="co">#&gt; phi       140.52279</span></span>
<span id="cb11-31"><a href="#cb11-31"></a><span class="co">#&gt; sigma      42.20112</span></span>
<span id="cb11-32"><a href="#cb11-32"></a><span class="co">#&gt; rho        26.56514</span></span>
<span id="cb11-33"><a href="#cb11-33"></a><span class="co">#&gt; exp(mu/2) 368.69311</span></span>
<span id="cb11-34"><a href="#cb11-34"></a><span class="co">#&gt; sigma^2    42.20112</span></span>
<span id="cb11-35"><a href="#cb11-35"></a><span class="kw">summary</span>(stochvolTMB_lev, <span class="dt">report =</span> <span class="st">&quot;transformed&quot;</span>)</span>
<span id="cb11-36"><a href="#cb11-36"></a><span class="co">#&gt;    parameter     estimate    std_error   z_value       p_value        type</span></span>
<span id="cb11-37"><a href="#cb11-37"></a><span class="co">#&gt; 1:   sigma_y  0.008338425 0.0004163323  20.02829  3.121840e-89 transformed</span></span>
<span id="cb11-38"><a href="#cb11-38"></a><span class="co">#&gt; 2:   sigma_h  0.273445746 0.0182642070  14.97167  1.124552e-50 transformed</span></span>
<span id="cb11-39"><a href="#cb11-39"></a><span class="co">#&gt; 3:       phi  0.967720808 0.0043682334 221.53597  0.000000e+00 transformed</span></span>
<span id="cb11-40"><a href="#cb11-40"></a><span class="co">#&gt; 4:       rho -0.748692587 0.0322489934 -23.21600 3.138829e-119 transformed</span></span></code></pre></div>
</div>
<div id="estimation" class="section level1">
<h1>Estimation</h1>
<p>The R-package <code>TMB</code> (<span class="citation">Kristensen et al. (2016)</span>) is used to implement our models for maximum likelihood estimation, since <code>TMB</code> lets us estimate parameters in models with a high number of latent variables.</p>
<p>Parameter estimation of stochastic volatility models is hard due to the fact the likelihood function is expressed as a high dimensional integral over the latent variables that cannot be evaluated analytically. If <span class="math inline">\(\boldsymbol{y} = (y_1, \ldots, y_T)\)</span> denotes our observations, <span class="math inline">\(\boldsymbol{h} = (h_1, \ldots, h_T)\)</span> our latent variables and <span class="math inline">\(\boldsymbol{\theta}\)</span> the parameters of interest, the likelihood of <span class="math inline">\(\boldsymbol{\theta}\)</span> is given by</p>
<p><span class="math display">\[\begin{equation}
    \mathcal{L}(\boldsymbol{\theta}) = \int f_{\boldsymbol{y}}(\boldsymbol{y}|\boldsymbol{h})f_{\boldsymbol{h}}(\boldsymbol{h}) \, d\boldsymbol{h},
\end{equation}\]</span></p>
<p>The conditional density of our observations given <span class="math inline">\(\boldsymbol{h}\)</span> is denoted by <span class="math inline">\(f_{\boldsymbol{y}}(\boldsymbol{y|u})\)</span>, and <span class="math inline">\(f_{\boldsymbol{h}}(\boldsymbol{h})\)</span> denotes the marginal density of <span class="math inline">\(\boldsymbol{h}\)</span>. To approximate this integral we apply the Laplace approximation.</p>
<div id="laplace-approximation" class="section level2">
<h2>Laplace Approximation</h2>
<p>Let <span class="math inline">\(\boldsymbol{y}\)</span> be a vector of observations, <span class="math inline">\(\boldsymbol{\theta}\)</span> our parameters of interest and <span class="math inline">\(\boldsymbol{h}\)</span> be a random vector of latent variables. Let <span class="math inline">\(g(\boldsymbol{h},\boldsymbol{\theta})\)</span> denote the negative joint log-likelihood. The likelihood of <span class="math inline">\(\boldsymbol{\theta}\)</span> is given by</p>
<p><span class="math display">\[\begin{equation}
    \mathcal{L}(\boldsymbol{\theta}) = \int f(\boldsymbol{y},\boldsymbol{h}) \, d\boldsymbol{h} = \int f_{\boldsymbol{y}}(\boldsymbol{y|u}) f_{\boldsymbol{h}}(\boldsymbol{h}) \, d\boldsymbol{h} = \int \exp \{-g(\boldsymbol{h},\boldsymbol{\theta})\} \, d\boldsymbol{h}.
\end{equation}\]</span></p>
<p>We assume that <span class="math inline">\(g\)</span> has a global minimum at <span class="math inline">\(\boldsymbol{\hat{h}}\)</span> for a given <span class="math inline">\(\boldsymbol{\theta}\)</span>, i.e. <span class="math inline">\(\boldsymbol{\hat{h}} = \text{argmin}_{\boldsymbol{h}} g(\boldsymbol{h},\boldsymbol{\theta})\)</span>, and that <span class="math inline">\(g\)</span> is twice differentiable. The solution <span class="math inline">\(\hat{\boldsymbol{h}}\)</span> is known as the <em>Empirical Bayes</em> (EB) estimate. A second order Taylor expansion around <span class="math inline">\(\boldsymbol{\hat{h}}\)</span> yields</p>
<p><span class="math display">\[\begin{equation}
    g(\boldsymbol{h},\boldsymbol{\theta}) \approx g(\boldsymbol{\hat{h}},\boldsymbol{\theta}) + \nabla g(\boldsymbol{\hat{h}},\boldsymbol{\theta})(\boldsymbol{h} - \boldsymbol{\hat{h}}) + \frac{1}{2}(\boldsymbol{h} - \boldsymbol{\hat{h}})^T\mathbb{H}(\boldsymbol{h} - \boldsymbol{\hat{h}})
\end{equation}\]</span></p>
<p>Since <span class="math inline">\(\boldsymbol{\hat{h}}\)</span> is a minimum, <span class="math inline">\(\nabla g(\boldsymbol{\hat{h}},\boldsymbol{\theta}) = 0\)</span>. Therefore</p>
<p><span class="math display">\[\begin{equation}
    \mathcal{L}(\boldsymbol{\theta}) \approx \exp \{-g(\boldsymbol{\hat{h}},\boldsymbol{\theta})\} \int \exp \bigg \{-\frac{1}{2}(\boldsymbol{h} - \boldsymbol{\hat{h}})^T\mathbb{H}(\boldsymbol{h} - \boldsymbol{\hat{h}}) \bigg \} d\boldsymbol{h}
\end{equation}\]</span></p>
<p>We can observe that the integrand is the kernel of a multivariate normal density with covariance matrix <span class="math inline">\(\mathbb{H}^{-1}\)</span>. The approximation is therefore given by</p>
<p><span class="math display">\[\begin{equation}
    \mathcal{L}(\boldsymbol{\theta}) \approx \exp \{-g(\boldsymbol{\hat{h}},\boldsymbol{\theta})\} (2\pi)^{\text{dim}(\boldsymbol{h})/2} \text{det}(\mathbb{H})^{-1/2},
\end{equation}\]</span></p>
<p>where we have used the fact that <span class="math inline">\(\text{det}(\mathbb{H}^{-1}) = \text{det}(\mathbb{H})^{-1}\)</span>. The corresponding negative log-likelihood is</p>
<p><span class="math display">\[\begin{equation}
    -l(\boldsymbol{\theta}) = -\frac{\text{dim}(\boldsymbol{h})}{2} \log (2\pi) + \frac{1}{2} \log \text{det}(\mathbb{H}) + g(\boldsymbol{\hat{h}},\boldsymbol{\theta}).
\end{equation}\]</span></p>
<p>Finding the optimal value of <span class="math inline">\(\boldsymbol{\theta}\)</span> can be viewed as a nested optimization problem. To find <span class="math inline">\(\boldsymbol{h} (\boldsymbol{\theta})\)</span> and <span class="math inline">\(\mathbb{H}(\boldsymbol{\theta})\)</span> we fix <span class="math inline">\(\boldsymbol{\theta}\)</span> and optimize using a quasi-Newton algorithm or a limited memory Newton method. The Laplace approximation is then optimized w.r.t. <span class="math inline">\(\boldsymbol{\theta}\)</span> using the quasi-Newton algorithm.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-kastner2016">
<p>Kastner, Gregor. 2016. “Dealing with Stochastic Volatility in Time Series Using the R Package stochvol.” <em>Journal of Statistical Software</em> 69 (5): 1–30. <a href="https://doi.org/10.18637/jss.v069.i05">https://doi.org/10.18637/jss.v069.i05</a>.</p>
</div>
<div id="ref-TMB_2016">
<p>Kristensen, Kasper, Anders Nielsen, Casper Berg, Hans Skaug, and Bradley Bell. 2016. “TMB: Automatic Differentiation and Laplace Approximation.” <em>Journal of Statistical Software, Articles</em> 70 (5): 1–21. <a href="https://doi.org/10.18637/jss.v070.i05">https://doi.org/10.18637/jss.v070.i05</a>.</p>
</div>
<div id="ref-Taylor_SV_1982">
<p>Taylor, S. J. 1982. “Financial Returns Modelled by the Product of Two Stochastic Processes-a Study of the Daily Sugar Prices 1961-75.” <em>Time Series Analysis : Theory and Practice</em> 1: 203–26. <a href="https://ci.nii.ac.jp/naid/10018822959/en/">https://ci.nii.ac.jp/naid/10018822959/en/</a>.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
